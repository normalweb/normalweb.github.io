/**
 * videoplay
 */
 
$(function(){
	if ($('.video-module').length > 0) {
		autoPlay('video-container', 'video-nav', 'video-clear', 500, 5000);
	}

	// 播放完整视频
	var videoSrc;
	var video;
	video = document.getElementById('orginal-video');
	$('.picbox .play, .video-play, .custom-1 .play, .voutilainen-1 .video, .imperial-palace-1 .video').click(function(){
		videoSrc = $(this).attr('video-href');
		video.src = videoSrc;
		//video.currentTime = 0;
		video.play();
		$('.play-box').show();
		$('.gray-bg').show();
		$('.gray-bg').one('click', function(){
			video.pause();
			$('.play-box').hide();
			$('.gray-bg').hide();
		});
		return false;
	});
	$('.play-box .close').click(function(){
		video.pause();
		$('.play-box').hide();
		$('.gray-bg').hide();
	});
});


function autoPlay(container, nav, clear, animateTime, infiniteTime){
	var init=0;
	var move;
	var containerElem = $('[node-type="'+container+'"]');
	var navElem = $('[node-type="'+nav+'"]');
	var clearElem = $('[node-type="'+clear+'"]');
	var len=parseInt(containerElem.find('.picbox').length);
	
	// 视频
	var v1 = document.getElementById('v1');
	var v3 = document.getElementById('v3');
	var v4 = document.getElementById('v4');
	//var v4 = customPicVideo();
	
	v1.play();
	v1.addEventListener('ended', function(){
		navElem.children('li').eq(1).click();
	}, false);
	v3.addEventListener('ended', function(){
		navElem.children('li').eq(4).click();
	}, false);
	v4.addEventListener('ended', function(){
		navElem.children('li').eq(0).click();
	}, false);
	
	var v2, v5;
	// 点击播放
	navElem.children('li').click(function(){
		init = $(this).index();
		v1.pause();
		v3.pause();
		v4.pause();
		switch (init) {
			case 0 :
				v1.currentTime = 0;
				v1.play();
				clearTimeout(v2);
				clearTimeout(v5);
			break;
			case 1 :
				v2 = setTimeout(function(){
					navElem.children('li').eq(2).click();
				}, 3000);
				clearTimeout(v5);
			break;
			case 2:
				v5 = setTimeout(function(){
					navElem.children('li').eq(3).click();
				}, 3000);
				clearTimeout(v2);
			break;
			case 3 :
				v3.currentTime = 0;
				v3.play();
				clearTimeout(v2);
				clearTimeout(v5);
			break;
			case 4 :
				v4.currentTime = 0;
				v4.play();
				clearTimeout(v2);
				clearTimeout(v5);
			break;
		}
		$(this).addClass("active").siblings().removeClass("active");
		containerElem.find('.picbox').eq(init).fadeIn(animateTime, function(){
			$(this).addClass("active");
		}).siblings().fadeOut(animateTime).removeClass("active");
	});
}

function customPicVideo() {
	var cron = setInterval(function(){
		var i = $('.custom-mobile.active').index();
		var len = $('.custom-mobile').length;
		
		if (i == len -1) j = 0;
		else j = i + 1;
		
		$('.custom-mobile').eq(i).fadeOut(500, function(){
			$(this).removeClass('active');
		});
		$('.custom-mobile').eq(j).fadeIn(500, function(){
			$(this).addClass('active');
		});
	}, 3000);
	
	return cron;
}